import{j as i,T as o,I as d,B as M,O as C,a as k,D as p,H as U}from"./index-DNJ-7_Rf.js";import{C as L}from"./config-global-CwnLHF89.js";import{u as f}from"./useQuery-Cikl35b1.js";import{C as y}from"./Card-98N49c-B.js";import{C as v}from"./CardContent-DR76uJN9.js";import{S as c}from"./Stack-BvggcJT0.js";import{S as j,z as e,E as g}from"./index-DnZn71We.js";import{G as x}from"./Grid-BaR81AYS.js";import{f as D}from"./format-CaAW2H5c.js";import{e as A}from"./es-AKIt1KYa.js";import"./colorManipulator-CN4-k9CK.js";import"./en-US-B7LV0LqM.js";const u={CLOUDS_STORM_RAIN:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFuEh7NndX59NiqZDOKwGaUEbMkIHFPmYLCBsh",NIGHT_MOON:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFV0W5urUjcl70YCAFJMna8NUu5iSIh3L4s9KO",NIGHT_MOON_CLOUDS:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFHH0bBNraBZhU4SsAtFWjHQPvJ7fkwO3ETxND",DAY_SUN:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFNWb4eKYoDwhs7LirRv6eFbP2yVmQjBulxU8C",DAY_CLOUDS:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFEQUJB6FxQDtned6qrHNXMlcGRPWTKfC23VSF",DAY_CLOUD_SUNLIGHT:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFh5auv0dDs4uS0O5kw7gZicfmeDLWtx9VldBU",DAY_SUNSET:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefF63CMtFv0s5x8Q4aVFIGMnWpY6SvKzygLCrhD",LIGHTSTORM:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefF0yfEX4nmyRzvYd41b08TBwSgZ2tr3DeHOPK7",RAIN:"https://srid7vtf90.ufs.sh/f/B7pTWizqIefFqaU1JRyIUlfSjRCd9EsvohwT78LYagceXi21"},R=(n,t)=>{const r=n.includes("d");if(t===800)return r?u.DAY_SUN:u.NIGHT_MOON;if([801,802].includes(t))return r?u.DAY_CLOUD_SUNLIGHT:u.NIGHT_MOON_CLOUDS;if([803,804].includes(t))return r?u.DAY_CLOUDS:u.NIGHT_MOON_CLOUDS;if(t>=200&&t<300)return u.LIGHTSTORM;if(t>=300&&t<400)return u.RAIN;if(t>=500&&t<600)return t>=520?u.CLOUDS_STORM_RAIN:u.RAIN;if(t>=600&&t<700||t>=700&&t<800)return r?u.DAY_CLOUDS:u.NIGHT_MOON_CLOUDS;const m=new Date().getHours();return m>=17&&m<18?u.DAY_SUNSET:r?u.DAY_SUN:u.NIGHT_MOON},H=({currentTemperature:n,feelsLike:t,iconLink:r,code:m})=>{const s=R(r,m);return i.jsx(y,{sx:{width:{xs:"100%",md:"50%"},height:{xs:"200px",md:"auto"},backgroundImage:`url(${s})`,backgroundSize:"cover",backgroundPosition:"center"},children:i.jsx(v,{sx:{height:"100%",position:"relative"},children:i.jsxs(c,{direction:"row",alignItems:"center",justifyContent:"space-between",height:"100%",children:[i.jsxs(c,{children:[i.jsxs(o,{variant:"h2",sx:{color:"white",textShadow:"2px 2px 4px rgba(0, 0, 0, 0.7)"},children:[n," °c"]}),i.jsxs(o,{variant:"body2",sx:{color:"white",textShadow:"2px 2px 4px rgba(0, 0, 0, 0.7)"},children:["sensación de ",t," °c"]})]}),i.jsx("img",{src:`https://openweathermap.org/img/wn/${r}@2x.png`,alt:"icono de clima"})]})})})},G=({minTemp:n,windSpeed:t,humidity:r,maxTemp:m,clouds:s,visibility:w})=>i.jsx(y,{sx:{width:{xs:"100%",md:"50%"}},children:i.jsxs(v,{children:[i.jsxs(c,{direction:{xs:"column",md:"row"},alignItems:"center",children:[i.jsxs(c,{direction:"row",alignItems:"center",spacing:2,width:{xs:"100%",md:"50%"},children:[i.jsx(d,{icon:"solar:sun-2-bold-duotone",width:28,color:"#1877F2"}),i.jsxs(c,{direction:"column",spacing:0,children:[i.jsx(o,{variant:"body2",component:"div",children:"Min Temp"}),i.jsxs(o,{variant:"subtitle1",component:"div",children:[n," °c"]})]})]}),i.jsxs(c,{direction:"row",alignItems:"center",spacing:2,width:{xs:"100%",md:"50%"},mt:{xs:2,md:0},children:[i.jsx(d,{icon:"solar:sun-2-bold-duotone",width:28,color:"#1877F2"}),i.jsxs(c,{direction:"column",spacing:0,children:[i.jsx(o,{variant:"body2",component:"div",children:"Max Temp"}),i.jsxs(o,{variant:"subtitle1",component:"div",children:[m," °c"]})]})]})]}),i.jsxs(c,{direction:{xs:"column",md:"row"},alignItems:"center",mt:2,children:[i.jsxs(c,{direction:"row",alignItems:"center",spacing:2,width:{xs:"100%",md:"50%"},children:[i.jsx(d,{icon:"solar:spedometer-low-bold-duotone",width:28,color:"#1877F2"}),i.jsxs(c,{direction:"column",spacing:0,children:[i.jsx(o,{variant:"body2",component:"div",children:"Humedad"}),i.jsxs(o,{variant:"subtitle1",component:"div",children:[r," %"]})]})]}),i.jsxs(c,{direction:"row",alignItems:"center",spacing:2,width:{xs:"100%",md:"50%"},mt:{xs:2,md:0},children:[i.jsx(d,{icon:"solar:wind-line-duotone",width:28,color:"#1877F2"}),i.jsxs(c,{direction:"column",spacing:0,children:[i.jsx(o,{variant:"body2",component:"div",children:"Viento"}),i.jsxs(o,{variant:"subtitle1",component:"div",children:[t," kph"]})]})]})]}),i.jsxs(c,{direction:{xs:"column",md:"row"},alignItems:"center",mt:2,children:[i.jsxs(c,{direction:"row",alignItems:"center",spacing:2,width:{xs:"100%",md:"50%"},children:[i.jsx(d,{icon:"solar:cloud-bold-duotone",width:28,color:"#1877F2"}),i.jsxs(c,{direction:"column",spacing:0,children:[i.jsx(o,{variant:"body2",component:"div",children:"Nubes"}),i.jsxs(o,{variant:"subtitle1",component:"div",children:[s," %"]})]})]}),i.jsxs(c,{direction:"row",alignItems:"center",spacing:2,width:{xs:"100%",md:"50%"},mt:{xs:2,md:0},children:[i.jsx(d,{icon:"solar:eye-bold-duotone",width:28,color:"#1877F2"}),i.jsxs(c,{direction:"column",spacing:0,children:[i.jsx(o,{variant:"body2",component:"div",children:"Visibilidad"}),i.jsxs(o,{variant:"subtitle1",component:"div",children:[w," km"]})]})]})]})]})}),P=()=>i.jsxs(i.Fragment,{children:[i.jsxs(c,{direction:{xs:"column",md:"row"},spacing:2,mt:2,children:[i.jsx(j,{variant:"rectangular",width:"100%",height:200,sx:{borderRadius:2}}),i.jsx(j,{variant:"rectangular",width:"100%",height:200,sx:{borderRadius:2}})]}),i.jsx(x,{container:!0,spacing:2,mt:1,children:[...Array(12)].map((n,t)=>i.jsx(x,{item:!0,xs:6,md:4,lg:3,children:i.jsx(j,{variant:"rectangular",width:"100%",height:200,sx:{borderRadius:2}})},t))})]});e.object({ip:e.string(),network:e.string(),version:e.enum(["IPv6","IPv4"]),city:e.string(),region:e.string(),region_code:e.string(),country:e.string(),country_name:e.string(),country_code:e.string(),country_code_iso3:e.string(),country_capital:e.string(),country_tld:e.string(),continent_code:e.string(),in_eu:e.boolean(),postal:e.string(),latitude:e.number(),longitude:e.number(),timezone:e.string(),utc_offset:e.string(),country_calling_code:e.string(),currency:e.string(),currency_name:e.string(),languages:e.string(),country_area:e.number(),country_population:e.number(),asn:e.string(),org:e.string()}).transform(n=>({ip:n.ip,network:n.network,version:n.version,city:n.city,region:n.region,regionCode:n.region_code,country:n.country,countryName:n.country_name,countryCode:n.country_code,countryCodeIso3:n.country_code_iso3,countryCapital:n.country_capital,countryTld:n.country_tld,continentCode:n.continent_code,inEu:n.in_eu,postal:n.postal,latitude:n.latitude,longitude:n.longitude,timezone:n.timezone,utcOffset:n.utc_offset,countryCallingCode:n.country_calling_code,currency:n.currency,currencyName:n.currency_name,languages:n.languages,countryArea:n.country_area,countryPopulation:n.country_population,asn:n.asn,org:n.org}));const z=e.object({name:e.string(),region:e.string(),country:e.string(),lat:e.number(),lon:e.number(),tz_id:e.string(),localtime_epoch:e.number(),localtime:e.string()}),B=e.object({last_updated_epoch:e.number(),last_updated:e.string(),temp_c:e.number(),temp_f:e.number(),is_day:e.number(),condition:e.object({text:e.string(),icon:e.string(),code:e.number()}),wind_mph:e.number(),wind_kph:e.number(),wind_degree:e.number(),wind_dir:e.string(),pressure_mb:e.number(),pressure_in:e.number(),precip_mm:e.number(),precip_in:e.number(),humidity:e.number(),cloud:e.number(),feelslike_c:e.number(),feelslike_f:e.number(),windchill_c:e.number(),windchill_f:e.number(),heatindex_c:e.number(),heatindex_f:e.number(),dewpoint_c:e.number(),dewpoint_f:e.number(),vis_km:e.number(),vis_miles:e.number(),uv:e.number(),gust_mph:e.number(),gust_kph:e.number()}),K=e.object({forecastday:e.array(e.object({astro:e.object({is_moon_up:e.number(),is_sun_up:e.number(),moon_illumination:e.number(),moon_phase:e.string(),moonrise:e.string(),moonset:e.string(),sunrise:e.string(),sunset:e.string()}),date:e.string(),date_epoch:e.number(),day:e.object({avghumidity:e.number(),avgtemp_c:e.number(),avgtemp_f:e.number(),avgvis_km:e.number(),avgvis_miles:e.number(),condition:e.object({code:e.number(),icon:e.string(),text:e.string()}),daily_chance_of_rain:e.number(),daily_chance_of_snow:e.number(),daily_will_it_rain:e.number(),daily_will_it_snow:e.number(),maxtemp_c:e.number(),maxtemp_f:e.number(),maxwind_kph:e.number(),maxwind_mph:e.number(),mintemp_c:e.number(),mintemp_f:e.number(),totalprecip_in:e.number(),totalprecip_mm:e.number(),totalsnow_cm:e.number(),uv:e.number()}),hour:e.array(e.object({chance_of_rain:e.number(),chance_of_snow:e.number(),cloud:e.number(),condition:e.object({code:e.number(),icon:e.string(),text:e.string()}),dewpoint_c:e.number(),dewpoint_f:e.number(),feelslike_c:e.number(),feelslike_f:e.number(),gust_kph:e.number(),gust_mph:e.number(),heatindex_c:e.number(),heatindex_f:e.number(),humidity:e.number(),is_day:e.number(),precip_in:e.number(),precip_mm:e.number(),pressure_in:e.number(),pressure_mb:e.number(),snow_cm:e.number(),temp_c:e.number(),temp_f:e.number(),time:e.string(),time_epoch:e.number(),uv:e.number(),vis_km:e.number(),vis_miles:e.number(),will_it_rain:e.number(),will_it_snow:e.number(),wind_degree:e.number(),wind_dir:e.string(),wind_kph:e.number(),wind_mph:e.number(),windchill_c:e.number(),windchill_f:e.number()}))}))});e.object({location:z,current:B,forecast:K}).transform(n=>({location:{name:n.location.name,region:n.location.region,country:n.location.country,latitude:n.location.lat,longitude:n.location.lon,timezoneId:n.location.tz_id,localtimeEpoch:n.location.localtime_epoch,localtime:n.location.localtime},currentWeather:{lastUpdatedEpoch:n.current.last_updated_epoch,lastUpdated:n.current.last_updated,tempC:n.current.temp_c,tempF:n.current.temp_f,isDay:n.current.is_day,condition:{text:n.current.condition.text,icon:n.current.condition.icon,code:n.current.condition.code},windMph:n.current.wind_mph,windKph:n.current.wind_kph,windDegree:n.current.wind_degree,windDir:n.current.wind_dir,pressureMb:n.current.pressure_mb,pressureIn:n.current.pressure_in,precipMm:n.current.precip_mm,precipIn:n.current.precip_in,humidity:n.current.humidity,cloud:n.current.cloud,feelslikeC:n.current.feelslike_c,feelslikeF:n.current.feelslike_f,windchillC:n.current.windchill_c,windchillF:n.current.windchill_f,heatindexC:n.current.heatindex_c,heatindexF:n.current.heatindex_f,dewpointC:n.current.dewpoint_c,dewpointF:n.current.dewpoint_f,visKm:n.current.vis_km,visMiles:n.current.vis_miles,uv:n.current.uv,gustMph:n.current.gust_mph,gustKph:n.current.gust_kph},forecast:n.forecast.forecastday.map(t=>({astro:{sunrise:t.astro.sunrise,sunset:t.astro.sunset,moonrise:t.astro.moonrise,moonset:t.astro.moonset,moonPhase:t.astro.moon_phase,moonIllumination:t.astro.moon_illumination,isMoonUp:t.astro.is_moon_up,isSunUp:t.astro.is_sun_up},date:t.date,dateEpoch:t.date_epoch,day:{avgTempC:t.day.avgtemp_c,avgTempF:t.day.avgtemp_f,maxTempC:t.day.maxtemp_c,maxTempF:t.day.maxtemp_f,minTempC:t.day.mintemp_c,minTempF:t.day.mintemp_f,avgHumidity:t.day.avghumidity,avgVisibilityKm:t.day.avgvis_km,avgVisibilityMiles:t.day.avgvis_miles,maxWindKph:t.day.maxwind_kph,maxWindMph:t.day.maxwind_mph,totalPrecipMm:t.day.totalprecip_mm,totalPrecipIn:t.day.totalprecip_in,totalSnowCm:t.day.totalsnow_cm,uvIndex:t.day.uv,dailyChanceOfRain:t.day.daily_chance_of_rain,dailyChanceOfSnow:t.day.daily_chance_of_snow,dailyWillItRain:t.day.daily_will_it_rain,dailyWillItSnow:t.day.daily_will_it_snow,condition:{text:t.day.condition.text,icon:t.day.condition.icon,code:t.day.condition.code},hour:t.hour.map(r=>({time:r.time,timeEpoch:r.time_epoch,temperatureC:r.temp_c,temperatureF:r.temp_f,feelsLikeC:r.feelslike_c,feelsLikeF:r.feelslike_f,dewPointC:r.dewpoint_c,dewPointF:r.dewpoint_f,windSpeedKph:r.wind_kph,windSpeedMph:r.wind_mph,windDegree:r.wind_degree,windDirection:r.wind_dir,gustSpeedKph:r.gust_kph,gustSpeedMph:r.gust_mph,pressureMb:r.pressure_mb,pressureIn:r.pressure_in,humidity:r.humidity,visibilityKm:r.vis_km,visibilityMiles:r.vis_miles,cloud:r.cloud,uvIndex:r.uv,chanceOfRain:r.chance_of_rain,chanceOfSnow:r.chance_of_snow,willItRain:r.will_it_rain,willItSnow:r.will_it_snow,precipitationMm:r.precip_mm,precipitationIn:r.precip_in,snowCm:r.snow_cm,heatIndexC:r.heatindex_c,heatIndexF:r.heatindex_f,windChillC:r.windchill_c,windChillF:r.windchill_f,condition:{text:r.condition.text,icon:r.condition.icon,code:r.condition.code}}))}}))}));const q=async()=>new Promise(async(n,t)=>{if("geolocation"in navigator)navigator.geolocation.getCurrentPosition(async r=>{n({latitude:r.coords.latitude,longitude:r.coords.longitude})},async r=>{console.warn("Geolocation failed, using IP-based location...",r);try{const m=await fetch("https://ipapi.co/json/");if(!m.ok)throw new Error("Network response was not ok");const s=await m.json();n({latitude:s.latitude,longitude:s.longitude})}catch{t(new Error("Failed to get location from both geolocation and IP."))}});else{console.warn("Geolocation is not supported, using IP-based location...");try{const r=await fetch("https://ipapi.co/json/");if(!r.ok)throw new Error("Network response was not ok");const m=await r.json();n({latitude:m.latitude,longitude:m.longitude})}catch{t(new Error("Failed to get location."))}}}),Y=({date:n,maxTemp:t,minTemp:r})=>{const m=D(new Date(n),"eeee, d MMM",{locale:A});return i.jsx(y,{sx:{width:"100%",textAlign:"center",borderRadius:2},children:i.jsxs(v,{children:[i.jsx(o,{variant:"h6",color:"text.primary",mb:2,textTransform:"capitalize",children:m}),i.jsxs(M,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyItems:"center",gap:1,width:"100%"},children:[i.jsxs(c,{direction:"row",spacing:2,children:[i.jsx(d,{icon:"solar:snowflake-bold-duotone",width:28,color:"#00AEEF"}),i.jsxs(c,{direction:"row",spacing:2,children:[i.jsx(o,{variant:"body2",color:"textSecondary",children:"Temperatura Mín"}),i.jsxs(o,{variant:"subtitle1",children:[r,"°C"]})]})]}),i.jsxs(c,{direction:"row",spacing:2,children:[i.jsx(d,{icon:"solar:sun-2-bold-duotone",width:28,color:"#FF9800"}),i.jsxs(c,{direction:"row",spacing:2,children:[i.jsx(o,{variant:"body2",color:"textSecondary",children:"Temperatura Máx"}),i.jsxs(o,{variant:"subtitle1",children:[t,"°C"]})]})]})]})]})})},W=e.object({base:e.string(),clouds:e.object({all:e.number()}),cod:e.number(),coord:e.object({lon:e.number(),lat:e.number()}),dt:e.number(),id:e.number(),main:e.object({feels_like:e.number(),grnd_level:e.number(),humidity:e.number(),pressure:e.number(),sea_level:e.number(),temp:e.number(),temp_max:e.number(),temp_min:e.number()}),name:e.string(),sys:e.object({country:e.string(),id:e.number().optional(),sunrise:e.number(),sunset:e.number(),type:e.number().optional()}),timezone:e.number(),visibility:e.number(),weather:e.array(e.object({description:e.string(),icon:e.string(),id:e.number(),main:e.string()})),wind:e.object({deg:e.number(),speed:e.number()})}),$=e.object({city:e.object({coord:e.object({lat:e.number(),lon:e.number()}),country:e.string(),id:e.number(),name:e.string(),population:e.number(),sunrise:e.number(),sunset:e.number(),timezone:e.number()}),cnt:e.number(),cod:e.string(),list:e.array(e.object({clouds:e.object({all:e.number()}),dt:e.number(),dt_txt:e.string(),main:e.object({feels_like:e.number(),grnd_level:e.number(),humidity:e.number(),pressure:e.number(),sea_level:e.number(),temp:e.number(),temp_max:e.number(),temp_min:e.number()}),pop:e.number(),sys:e.object({pod:e.string().optional()}),visibility:e.number(),weather:e.array(e.object({description:e.string(),icon:e.string(),id:e.number(),main:e.string()})),wind:e.object({deg:e.number(),speed:e.number()})})),message:e.number()}),V=async(n,t)=>{if(!n||!t)throw new Error("Missing lat or long");try{const r=await fetch(`${C}/weather?lat=${n}&lon=${t}&appid=${k}&units=metric`);if(!r.ok)throw new Error("Network response was not ok");const m=await r.json();return W.parse(m)}catch(r){throw r instanceof e.ZodError?(console.error("Validation error:",r.errors),new Error(r.message)):new Error(`Failed to get webhooks: ${r}`)}},Q=async(n,t)=>{if(!n||!t)throw new Error("Missing lat or long");try{const r=await fetch(`${C}/forecast?lat=${n}&lon=${t}&appid=${k}&units=metric`);if(!r.ok)throw new Error("Network response was not ok");const m=await r.json();return $.parse(m)}catch(r){throw r instanceof e.ZodError?(console.error("Validation error:",r.errors),new Error(r.message)):new Error(`Failed to get webhooks: ${r}`)}};function Z(){var I;const{data:n,isLoading:t,isError:r,error:m}=f({queryKey:["user-lat-long"],queryFn:q}),{data:s,isLoading:w,isError:S,error:F}=f({queryKey:["open-weather-info"],queryFn:()=>V((n==null?void 0:n.latitude)||0,(n==null?void 0:n.longitude)||0),enabled:!!(n!=null&&n.latitude)&&!!(n!=null&&n.longitude)}),{data:h,isLoading:T,isError:E,error:O}=f({queryKey:["open-weather-forecast"],queryFn:()=>Q((n==null?void 0:n.latitude)||0,(n==null?void 0:n.longitude)||0),enabled:!!(n!=null&&n.latitude)&&!!(n!=null&&n.longitude)});if(t||w||T)return i.jsxs(p,{children:[i.jsx(o,{variant:"h4",children:"Clima"}),i.jsx(P,{})]});if(r)return i.jsxs(p,{children:[i.jsx(o,{variant:"h4",children:"Clima"}),i.jsx(g,{message:m.message})]});if(S)return i.jsxs(p,{children:[i.jsx(o,{variant:"h4",children:"Clima"}),i.jsx(g,{message:F.message})]});if(E)return i.jsxs(p,{children:[i.jsx(o,{variant:"h4",children:"Clima"}),i.jsx(g,{message:O.message})]});if(!s||!h)return i.jsxs(p,{children:[i.jsx(o,{variant:"h4",children:"Clima"}),i.jsx(g,{message:"Sin datos"})]});const N=s.visibility/1e3,b=h==null?void 0:h.list.reduce((l,_)=>{const a=_.dt_txt.split(" ")[0];return l[a]?(l[a].temp_min=Math.min(l[a].temp_min,_.main.temp_min),l[a].temp_max=Math.max(l[a].temp_max,_.main.temp_max)):l[a]={temp_min:_.main.temp_min,temp_max:_.main.temp_max},l},{});return i.jsxs(p,{children:[i.jsx(o,{variant:"h4",children:"Clima"}),i.jsxs(o,{variant:"subtitle2",component:"div",children:[s==null?void 0:s.name,", ",s==null?void 0:s.sys.country]}),i.jsxs(c,{direction:{xs:"column",md:"row"},spacing:2,mt:2,children:[i.jsx(H,{currentTemperature:s==null?void 0:s.main.temp,feelsLike:s==null?void 0:s.main.feels_like,iconLink:(I=s==null?void 0:s.weather[0])==null?void 0:I.icon,code:s==null?void 0:s.weather[0].id}),i.jsx(G,{minTemp:s.main.temp_min,windSpeed:s==null?void 0:s.wind.speed,humidity:s==null?void 0:s.main.humidity,maxTemp:s.main.temp_max,clouds:s==null?void 0:s.clouds.all,visibility:N||0})]}),i.jsx(x,{container:!0,spacing:2,mt:1,children:b&&Object.keys(b).map(l=>i.jsx(x,{item:!0,xs:12,md:4,children:i.jsx(Y,{date:l,maxTemp:b[l].temp_max,minTemp:b[l].temp_min})},crypto.randomUUID()))})]})}function le(){return i.jsxs(i.Fragment,{children:[i.jsx(U,{children:i.jsxs("title",{children:[" ",`Pronóstico - ${L.appName}`]})}),i.jsx(Z,{})]})}export{le as default};
