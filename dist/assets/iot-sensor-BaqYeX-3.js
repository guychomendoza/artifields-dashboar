import{g as ae,e as se,s as E,T as b,r as g,f as ie,k as oe,j as e,_ as ne,o as re,p as le,aa as O,M as ce,v as de,a2 as ue,l as ee,E as me,d as W,I as k,B as S,x as he,u as pe,D as xe,H as ge}from"./index-DNJ-7_Rf.js";import{C as fe}from"./config-global-CwnLHF89.js";import{g as F,e as be,h as je}from"./iot-Dg2SjAsq.js";import{f as ve}from"./utils-DgT3aVHO.js";import{i as P,s as A,a as L,b as G,D as ye,R as Se,L as Ce,C as we,X as ke,Y as De,T as Te,c as Me,d as Ie}from"./LineChart-C4DfYQFE.js";import{e as B,S as te}from"./Slider-CXET07Dr.js";import{S as y}from"./Stack-BvggcJT0.js";import{F as Ne,I as Pe,S as Ae,c as Le}from"./Select-C6NYPjTS.js";import{s as D,f as _}from"./format-CaAW2H5c.js";import{u as V}from"./useMediaQuery-BWWVbJPQ.js";import{C as w}from"./Card-98N49c-B.js";import{C as T}from"./CardContent-DR76uJN9.js";import{C as Be}from"./Checkbox-DQfe5e9M.js";import{C as M}from"./CardHeader-BODd0mTE.js";import{G as K}from"./Grid-BaR81AYS.js";import{e as R}from"./es-AKIt1KYa.js";import{c as _e,A as Re,M as $e,u as ze}from"./index.modern-BSJ2A2Eu.js";import{T as We,a as U}from"./Tabs-D274aWzn.js";import{C as Ee}from"./CircularProgress-DypZclCl.js";import"./en-US-B7LV0LqM.js";import"./index-BMHLmDq2.js";import"./useControlled-CYejl48w.js";import"./SwitchBase-DJ_sWzg7.js";import"./index-KKIBTe8w.js";import"./KeyboardArrowRight-DgOaYwjI.js";function He(t){return se("MuiAlertTitle",t)}ae("MuiAlertTitle",["root"]);const Ve=["className"],Fe=t=>{const{classes:a}=t;return le({root:["root"]},He,a)},Oe=E(b,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(t,a)=>a.root})(({theme:t})=>({fontWeight:t.typography.fontWeightMedium,marginTop:-2})),Ge=g.forwardRef(function(a,s){const i=ie({props:a,name:"MuiAlertTitle"}),{className:o}=i,m=oe(i,Ve),h=i,j=Fe(h);return e.jsx(Oe,ne({gutterBottom:!0,component:"div",ownerState:h,ref:s,className:re(j.root,o)},m))}),X=t=>{let a;const s=new Set,i=(d,x)=>{const n=typeof d=="function"?d(a):d;if(!Object.is(n,a)){const r=a;a=x??(typeof n!="object"||n===null)?n:Object.assign({},a,n),s.forEach(u=>u(a,r))}},o=()=>a,j={setState:i,getState:o,getInitialState:()=>p,subscribe:d=>(s.add(d),()=>s.delete(d))},p=a=t(i,o,j);return j},Ke=t=>t?X(t):X,Ue=t=>t;function Xe(t,a=Ue){const s=O.useSyncExternalStore(t.subscribe,()=>a(t.getState()),()=>a(t.getInitialState()));return O.useDebugValue(s),s}const Z=t=>{const a=Ke(t),s=i=>Xe(a,i);return Object.assign(s,a),s},Ze=t=>t?Z(t):Z,N=Ze(t=>({allMeasurements:[],setAllMeasurements:a=>t(()=>({allMeasurements:a})),selectedMeasurement:null,setSelectedMeasurement:a=>t(()=>({selectedMeasurement:a}))})),Ye=({measurements:t,onRangeChange:a})=>{var v;const{oldestDate:s,newestDate:i}=g.useMemo(()=>{const l=t.map(c=>c.timestamp?new Date(c.timestamp):null).filter(c=>c!==null);return{oldestDate:D(new Date(Math.min(...l.map(c=>c.getTime())))),newestDate:B(new Date(Math.max(...l.map(c=>c.getTime()))))}},[t]),o=g.useMemo(()=>{const l=[],c=i;return P(A(c,1),{start:s,end:c})&&l.push({label:"1 Semana",value:"1w"}),P(A(c,2),{start:s,end:c})&&l.push({label:"2 Semanas",value:"2w"}),P(L(c,1),{start:s,end:c})&&l.push({label:"1 Mes",value:"1m"}),P(L(c,6),{start:s,end:c})&&l.push({label:"6 Meses",value:"6m"}),P(G(c,1),{start:s,end:c})&&l.push({label:"1 Año",value:"1y"}),l.push({label:"Rango Personalizado",value:"custom"}),l},[s,i]),[m,h]=g.useState((v=o[0])==null?void 0:v.value),[j,p]=g.useState({from:s,to:i}),[d,x]=g.useState(null);g.useEffect(()=>{if(!o[0])return;const l=B(i),c=D(A(l,1));h(o[0].value),a([c,l]),p({from:c,to:l})},[]);const n=l=>{const c=l.target.value;if(h(c),c==="custom")return;let C=D(i);const I=B(i);switch(c){case"1w":C=D(A(i,1));break;case"2w":C=D(A(i,2));break;case"1m":C=D(L(i,1));break;case"6m":C=D(L(i,6));break;case"1y":C=D(G(i,1));break}p({from:C,to:I}),a([C,I])},r=l=>{if(l.from&&l.to){const c=D(l.from),C=B(l.to);p({from:c,to:C}),h("custom"),a([c,C])}},u=l=>x(l.currentTarget),f=()=>x(null);return e.jsxs(y,{className:"flex flex-col gap-4 p-4",direction:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},justifyContent:{xs:"stretch",sm:"start"},spacing:2,mb:2,children:[e.jsxs(Ne,{className:"min-w-[200px]",children:[e.jsx(Pe,{children:"Rango de Tiempo"}),e.jsx(Ae,{value:m,label:"Rango de Tiempo",onChange:n,size:"small",children:o.map(l=>e.jsx(ce,{value:l.value,children:l.label},l.value))})]}),m==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx(de,{variant:"outlined",onClick:u,children:"Seleccionar Rango de Fechas"}),e.jsx(ue,{open:!!d,anchorEl:d,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"left"},sx:{"& .MuiPopover-paper":{p:2}},children:e.jsx(ye,{mode:"range",selected:j,onSelect:l=>r(l),disabled:{before:s,after:i},showOutsideDays:!0})})]})]})},qe=[{key:"temperatura_suelo",label:"Temperatura del Suelo"},{key:"bateria",label:"Batería"},{key:"conductividad_suelo",label:"Conductividad del Suelo"},{key:"agua_suelo",label:"Humedad del Suelo"}],Qe=2,Je=({selectedOptions:t,setSelectedOptions:a})=>{const s=ee(),i=V(s.breakpoints.down("sm"));return e.jsx(w,{sx:{mt:2},children:e.jsxs(T,{children:[i&&t.length>=Qe&&e.jsxs(me,{severity:"info",sx:{mb:2},children:[e.jsx(Ge,{children:"Recomendación de visualización"}),"No se recomienda ver muchos ejes simultáneamente en teléfonos móviles. Para una mejor experiencia con múltiples ejes, utilice una tablet o computadora."]}),qe.map(o=>e.jsxs(y,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Be,{checked:t.includes(o.key),onChange:()=>{a(t.includes(o.key)?t.filter(m=>m!==o.key):[...t,o.key])}}),e.jsx(Le,{children:o.label})]},o.key))]})})},z={"Temperatura del Suelo":{unit:"°C",color:"#2E93fA"},"Humedad del Suelo":{unit:"%",color:"#66DA26"},"Conductividad del Suelo":{unit:"uS/cm",color:"#546E7A"},Batería:{unit:"%",color:"#E91E63"}},$={temperatura_suelo:"Temperatura del Suelo",bateria:"Batería",conductividad_suelo:"Conductividad del Suelo",agua_suelo:"Humedad del Suelo"},et=({active:t,payload:a,label:s})=>t&&a&&a.length?e.jsxs(w,{elevation:3,sx:{p:2,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider"},children:[e.jsx(b,{variant:"body2",color:"text.secondary",sx:{mb:1},children:s}),e.jsx(y,{spacing:1,children:a.map(i=>{var o;return e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(S,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:i.color}}),e.jsxs(b,{variant:"body2",sx:{fontWeight:"medium"},children:[i.name,":"]}),e.jsxs(b,{variant:"body2",children:[i.value," ",(o=z[i.name])==null?void 0:o.unit]})]},i.name)})})]}):null,tt=({measurements:t=[],selectedOptions:a=[]})=>{const s=ee(),i=V("(min-width:768px)"),o=V("(max-width:767px)"),[m,h]=g.useState([]),j=g.useMemo(()=>[...t].sort((r,u)=>new Date(r.timestamp).getTime()-new Date(u.timestamp).getTime()).map(r=>({timestamp:r.timestamp,date:_(new Date(r.timestamp),"dd/MM HH:mm",{locale:R}),...a.reduce((u,f)=>{const v=r[f];return u[$[f]]=v!==void 0&&parseFloat(String(v))||0,u},{})})),[t,a]),p=n=>{if(n&&n.activePayload&&n.activePayload.length>0){const r={};n.activePayload.forEach(u=>{r[u.name]=u.value}),r.date=n.activeLabel,h(u=>[...u,r])}},d=n=>{h(r=>r.filter((u,f)=>f!==n))},x=g.useMemo(()=>m.map(n=>{const r=t.find(u=>_(new Date(u.timestamp),"dd/MM HH:mm",{locale:R})===n.date.toString());return r&&a.forEach(u=>{const f=$[u],v=r[u];n[f]=v!==void 0&&parseFloat(String(v))||0}),n}),[m,a,t]);return e.jsxs(w,{children:[e.jsx(M,{title:"Análisis de Datos del Sensor",subheader:"Visualice los datos de su sensor"}),e.jsx(K,{container:!0,spacing:1,sx:{p:1},children:x.map((n,r)=>{var u;return e.jsx(K,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(w,{elevation:2,sx:{position:"relative"},children:[e.jsx(W,{"aria-label":"remove point",size:"small",sx:{position:"absolute",top:4,right:4},onClick:()=>d(r),children:e.jsx(k,{icon:"ic:round-close"})}),e.jsxs(T,{children:[e.jsx(b,{variant:"caption",sx:{fontWeight:"semibold"},children:_(new Date(((u=t.find(f=>_(new Date(f.timestamp),"dd/MM HH:mm",{locale:R})===n.date))==null?void 0:u.timestamp)||new Date),"dd/MM/yyyy HH:mm",{locale:R})}),e.jsx(y,{spacing:.5,children:Object.entries(n).filter(([f])=>f!=="date").map(([f,v])=>{var l;return e.jsxs(b,{variant:"caption",sx:{fontWeight:"normal"},children:[f,": ",v," ",(l=z[f])==null?void 0:l.unit]},f)})})]})]})},r)})}),a.length>0?e.jsx(T,{sx:{height:o?"400px":"500px",p:0,px:2},children:e.jsx(Se,{children:e.jsxs(Ce,{data:j,margin:i?{top:5,right:5,left:5,bottom:15}:{top:0,right:0,left:0,bottom:0},onClick:p,children:[e.jsx(we,{strokeDasharray:"3 3",stroke:s.palette.divider,vertical:i}),e.jsx(ke,{dataKey:"date",tick:i?{fill:s.palette.text.secondary,fontSize:12}:!1,tickLine:i?{stroke:s.palette.divider}:!1,axisLine:{stroke:s.palette.divider},interval:i?"preserveStartEnd":0,height:i?80:10,angle:-45}),a.map((n,r)=>{const u=$[n],{unit:f}=z[u];return e.jsx(De,{yAxisId:n,orientation:r%2===0?"left":"right",tickFormatter:v=>`${v}${f}`,tick:i?{fill:s.palette.text.secondary,fontSize:12}:{fill:s.palette.text.secondary,fontSize:10},tickLine:{stroke:s.palette.divider},axisLine:{stroke:s.palette.divider},domain:["auto","auto"],width:i?80:50},n)}),e.jsx(Te,{content:e.jsx(et,{}),cursor:{stroke:s.palette.divider}}),e.jsx(Me,{verticalAlign:"top",height:o?40:36,wrapperStyle:{paddingTop:"10px",fontSize:i?"12px":"10px",display:"flex",justifyContent:"center",flexWrap:"wrap",gap:"8px"},iconType:"circle",iconSize:i?10:8,layout:"horizontal"}),a.map(n=>{const r=$[n],{color:u}=z[r];return e.jsx(Ie,{yAxisId:n,type:"monotone",dataKey:r,name:r,stroke:u,connectNulls:!0,dot:f=>{const{cx:v,cy:l,payload:c}=f;return m.some(I=>I.date===c.date&&I[r]===c[r])?e.jsx("circle",{cx:v,cy:l,r:i?4:3,fill:"white",stroke:u,strokeWidth:2}):null},strokeWidth:o?1.5:2,activeDot:{r:i?4:3,strokeWidth:0}},n)})]})})}):e.jsx(T,{children:e.jsx(b,{variant:"body1",color:"textSecondary",children:"No hay datos disponibles para las opciones seleccionadas."})})]})},at=()=>{const{allMeasurements:t}=N(),[a,s]=g.useState([]),[i,o]=g.useState([]),m=h=>{const[j,p]=h,d=t.filter(x=>{const n=new Date(x.timestamp);return n>=j&&n<=p});s(d)};return e.jsxs(S,{children:[e.jsx(Ye,{measurements:t,onRangeChange:m}),e.jsx(tt,{measurements:a,selectedOptions:i}),e.jsx(Je,{selectedOptions:i,setSelectedOptions:o})]})},st=()=>{var i,o,m,h;const[t,a]=g.useState(null),{selectedMeasurement:s}=N();return g.useEffect(()=>{(async()=>{if(!(s!=null&&s.ultimaMedicion.dispositivo_id))return;const p=await F(s==null?void 0:s.ultimaMedicion.dispositivo_id);if(!p)return;const d=Number(p.lat),x=Number(p.long);if(!d||!x){a(null);return}const r=await fetch(`https://api.weatherapi.com/v1/current.json?key=7bd4b358a35f4659b6a10855242811&q=${d},${x}&aqi=no`);if(!r.ok)return console.error("Failed to fetch weather data"),null;const u=await r.json();a(u)})()},[s]),t?e.jsxs(e.Fragment,{children:[e.jsxs(y,{direction:"row",spacing:2,sx:{height:{xs:"auto",lg:"100%"}},children:[e.jsxs(w,{sx:{width:"100%"},children:[e.jsx(M,{title:"Temperatura",sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"}}),e.jsx(T,{sx:{padding:1.5,paddingBottom:0},children:e.jsxs(b,{variant:"h6",children:[(i=t==null?void 0:t.current)==null?void 0:i.temp_c," ",e.jsx(b,{variant:"body2",color:"textSecondary",component:"span",children:"°C"})]})})]}),e.jsxs(w,{sx:{width:"100%"},children:[e.jsx(M,{title:"Velocidad del Viento",sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"}}),e.jsx(T,{sx:{padding:1.5,paddingBottom:0},children:e.jsxs(b,{variant:"h6",children:[(o=t==null?void 0:t.current)==null?void 0:o.wind_kph," ",e.jsx(b,{variant:"body2",color:"textSecondary",component:"span",children:"kph"})]})})]})]}),e.jsxs(y,{direction:"row",spacing:2,sx:{height:{xs:"auto",lg:"100%"}},children:[e.jsxs(w,{sx:{width:"100%"},children:[e.jsx(M,{title:"UV",sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"}}),e.jsx(T,{sx:{padding:1.5,paddingBottom:0},children:e.jsx(b,{variant:"h6",children:(m=t==null?void 0:t.current)==null?void 0:m.uv})})]}),e.jsxs(w,{sx:{width:"100%"},children:[e.jsx(M,{title:"Humedad",sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"}}),e.jsx(T,{sx:{padding:1.5,paddingBottom:0},children:e.jsx(b,{variant:"h6",children:(h=t==null?void 0:t.current)==null?void 0:h.humidity})})]})]})]}):e.jsxs(y,{direction:"column",alignItems:"center",justifyContent:"center",sx:{height:{xs:"auto",lg:"100%"}},children:[e.jsx(k,{icon:"solar:cloud-bold-duotone",fontSize:"large"}),e.jsx(b,{variant:"body1",children:"Sin datos por mostrar"})]})},it=({position:t})=>e.jsx(_e,{position:t,children:e.jsxs("div",{className:"marker-container",children:[e.jsx("div",{className:"pulse-ring"}),e.jsx("div",{className:"pulse-dot"}),e.jsx("div",{className:"marker-dot"}),e.jsx("div",{className:"marker-label",children:"Device Location"})]})}),ot=({lat:t,lng:a})=>{const s=ze(),i=()=>{s&&(s.panTo({lat:t,lng:a}),s.setZoom((s.getZoom()||5)+1))};return e.jsx(W,{onClick:i,sx:{position:"absolute",bottom:16,right:16,zIndex:999,bgcolor:"background.paper","&:hover":{bgcolor:"background.paper"}},size:"large",children:e.jsx(k,{icon:"solar:magnifer-zoom-in-bold"})})},nt=()=>{const{selectedMeasurement:t}=N(),[a,s]=g.useState(null);return g.useEffect(()=>{if(!t)return;t&&(async()=>{const o=await F(t==null?void 0:t.ultimaMedicion.dispositivo_id);o&&s(o)})()},[t]),a?e.jsx(Re,{apiKey:"AIzaSyB_LTdB65XirnWx_f6IrloEw0_Gc70L0ps",children:e.jsxs(S,{sx:{position:"relative",width:{xs:"100%",lg:"50%"},minHeight:"45rem",height:{xs:"500px",lg:"calc(100vh - 19rem)"},borderRadius:"8px",overflow:"hidden"},children:[e.jsx($e,{streetViewControl:!1,defaultZoom:a!=null&&a.lat&&(a!=null&&a.long)?15:5,defaultCenter:{lat:a!=null&&a.lat?Number(a==null?void 0:a.lat):23.6345,lng:a!=null&&a.long?Number(a==null?void 0:a.long):-102.5528},mapTypeId:"satellite",gestureHandling:"greedy",mapId:"f1b7b1b3b1b3b1b3",zoomControl:!1,children:a&&a.lat&&a.long&&e.jsx(it,{position:{lat:Number(a.lat),lng:Number(a.long)}})}),a&&a.lat&&a.long&&e.jsx(ot,{lat:Number(a.lat),lng:Number(a.long)})]})}):null},rt=E("div")(()=>({position:"absolute",display:"flex",alignItems:"center",right:0,transform:"translateY(-50%)"})),lt=E("div")(({color:t})=>({width:"3rem",borderTop:`2px dashed ${t}`})),ct=E("span")(({color:t})=>({marginLeft:"8px",fontSize:"0.75rem",color:t})),dt=()=>{var p;const{selectedMeasurement:t}=N(),a=(t==null?void 0:t.sensorInfo.limite_inferior)??0,s=(t==null?void 0:t.sensorInfo.limite_superior)??100,i=t!=null&&t.sensorInfo.capacidadIdeal?Number(t.sensorInfo.capacidadIdeal):null,o=10,m=50,h=d=>d?(d-o)/(m-o)*100:0,j=[{value:h(a),color:"#ff0000",label:`${a}`,condition:a>=o},{value:h(s),color:"#0b2af1",label:`${s}`,condition:s<=m}].filter(({condition:d})=>d);return e.jsxs(w,{sx:{width:"100%",height:{xs:"300px",lg:"100%"}},children:[e.jsx(M,{title:"Humedad",sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"},avatar:e.jsx(k,{icon:"solar:waterdrops-line-duotone"})}),e.jsxs(S,{px:3,height:{xs:"calc(100% - 4rem)",lg:"calc(100% - 3rem)"},display:"flex",alignItems:"center",justifyContent:"center",position:"relative",sx:{paddingLeft:8},children:[e.jsx(S,{position:"absolute",height:"90%",right:"30%",sx:{transform:"translateX(12px)"},children:j.map(({value:d,color:x,label:n})=>e.jsx(S,{position:"absolute",style:{bottom:`${d}%`,width:"100%"},children:e.jsxs(rt,{color:x,children:[e.jsx(lt,{color:x}),e.jsx(ct,{color:x,children:n})]})},n))}),e.jsx(te,{track:!1,marks:[{value:0,label:`${o}%`},{value:h(i),label:t!=null&&t.sensorInfo.capacidadIdeal?`${t==null?void 0:t.sensorInfo.capacidadIdeal}%`:""},{value:100,label:`${m}%`}].filter(Boolean),orientation:"vertical",value:(p=t==null?void 0:t.ultimaMedicion)!=null&&p.agua_suelo?h(Number(t.ultimaMedicion.agua_suelo)):0,valueLabelFormat:()=>t==null?void 0:t.ultimaMedicion.agua_suelo,disabled:!0,valueLabelDisplay:"on",sx:{height:"90%",width:8,"& .MuiSlider-rail":{background:"linear-gradient(to top, #f10b0b, #f1ee0b, #0b2af1)",opacity:1},"& .MuiSlider-thumb":{backgroundColor:"#fff",border:"2px solid currentColor",width:16,height:16}}})]})]})},Y=({title:t,units:a,value:s,icon:i,...o})=>e.jsxs(w,{...o,sx:{width:"100%",height:{xs:"200px",lg:"100%"}},children:[e.jsx(M,{title:t,sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"},avatar:i}),e.jsx(T,{sx:{padding:1.5},children:e.jsxs(b,{variant:"h6",children:[s," ",e.jsx(b,{variant:"body2",color:"textSecondary",component:"span",children:a})]})})]});function ut({title:t,colors:a,percent:s,formatTextValue:i,icon:o,temperature:m="0",...h}){const j=parseFloat(m),p=0,d=50,x=n=>n?(n-p)/(d-p)*100:0;return e.jsxs(w,{...h,sx:{width:"100%",height:{xs:"300px",lg:"100%"}},children:[e.jsx(M,{title:t,sx:{padding:1.5,paddingBottom:0},titleTypographyProps:{variant:"body1",fontWeight:"medium"},avatar:o}),e.jsx(S,{px:3,height:{xs:"calc(100% - 4rem)",lg:"calc(100% - 3rem)"},display:"flex",alignItems:"center",justifyContent:"center",sx:{paddingLeft:8},children:e.jsx(te,{track:!1,marks:[{value:0,label:`${p}°c`},{value:100,label:`${d}°c`}],disabled:!0,orientation:"vertical",valueLabelDisplay:"on",value:x(j),valueLabelFormat:()=>`${j}°c`,sx:{height:"90%",width:8,"& .MuiSlider-rail":{background:`linear-gradient(to top, ${a[0]}, ${a[1]}, ${a[2]})`,opacity:1},"& .MuiSlider-thumb":{backgroundColor:"#fff",border:"2px solid currentColor",width:16,height:16}}})})]})}const H=-20,q=50,mt=()=>{const{selectedMeasurement:t}=N(),a=s=>{const i=Number(s);return!i&&i!==0?0:(Math.max(H,Math.min(i,q))-H)/(q-H)*100};return e.jsxs(y,{direction:{xs:"column",lg:"row"},spacing:2,sx:{minHeight:"45rem",height:{xs:"auto",lg:"calc(100vh - 19rem)"}},children:[e.jsxs(y,{direction:"column",spacing:2,sx:{width:{xs:"100%",lg:"50%"},height:"100%"},children:[e.jsxs(y,{sx:{width:"100%",height:{xs:"auto",lg:"60%"}},direction:"column",spacing:1,children:[e.jsx(b,{variant:"h6",children:"Datos del sensor"}),e.jsxs(y,{direction:"row",spacing:1,sx:{width:"100%",height:{xs:"auto",lg:"60%"}},children:[e.jsx(dt,{}),e.jsx(ut,{title:"Temperatura del Suelo",colors:["#0b2af1","#f1ee0b","#f10b0b"],percent:a(t==null?void 0:t.ultimaMedicion.temperatura_suelo),formatTextValue:()=>`${t==null?void 0:t.ultimaMedicion.temperatura_suelo}°C`,temperature:(t==null?void 0:t.ultimaMedicion.temperatura_suelo)||"0",icon:e.jsx(k,{icon:"solar:sun-2-line-duotone"})})]}),e.jsxs(y,{direction:"row",spacing:1,sx:{width:"100%",height:{xs:"auto",lg:"40%"}},children:[e.jsx(Y,{title:"Conductividad del Suelo",value:Number(t==null?void 0:t.ultimaMedicion.conductividad_suelo),units:"uS/cm",icon:e.jsx(k,{icon:"solar:bolt-bold-duotone"})}),e.jsx(Y,{title:"Batería",value:Number(t==null?void 0:t.ultimaMedicion.bateria),icon:e.jsx(k,{icon:"solar:battery-charge-minimalistic-bold-duotone"}),units:"%"})]})]}),e.jsxs(y,{direction:"column",spacing:1,padding:1,sx:{width:"100%",height:{xs:"auto",lg:"40%"},backgroundColor:s=>s.palette.grey[200],borderRadius:3,border:"1px dashed",borderColor:s=>s.palette.grey[300]},children:[e.jsx(b,{variant:"h6",children:"Clima"}),e.jsx(st,{})]})]}),e.jsx(nt,{})]})},ht=()=>{const[t,a]=g.useState(0),s=(i,o)=>{a(o)};return e.jsxs(e.Fragment,{children:[e.jsxs(We,{value:t,onChange:s,"aria-label":"vistas-disponibles",sx:{mt:3},children:[e.jsx(U,{label:"dashboard",...Q(0),sx:{borderRadius:1,marginBottom:.5},icon:e.jsx(k,{icon:"solar:code-scan-bold"}),iconPosition:"start"}),e.jsx(U,{label:"Historial",...Q(1),sx:{borderRadius:1,marginBottom:.5},icon:e.jsx(k,{icon:"solar:graph-bold"}),iconPosition:"start"})]}),e.jsx(J,{value:t,index:0,children:e.jsx(mt,{})}),e.jsx(J,{value:t,index:1,children:e.jsx(at,{})})]})};function Q(t){return{id:`simple-tab-${t}`,"aria-controls":`simple-tabpanel-${t}`}}function J(t){const{children:a,value:s,index:i,...o}=t;return e.jsx("div",{role:"tabpanel",hidden:s!==i,id:`vista-${i}`,"aria-labelledby":`vista-${i}`,...o,children:s===i&&e.jsx(S,{sx:{mt:2},children:a})})}const pt=()=>{const t=he(),{sensorId:a}=pe(),{setSelectedMeasurement:s,setAllMeasurements:i,selectedMeasurement:o}=N(),[m,h]=g.useState(""),[j,p]=g.useState(!0),d=g.useCallback(async()=>{if(!a)return;p(!0);const x=await be(a),n=await je(a),r=await F(a);r&&h(r.nombre||""),x.length>0&&i(x),n&&s(n),p(!1)},[a,i,s]);return g.useEffect(()=>{d()},[d]),e.jsx(xe,{children:j?e.jsx(S,{display:"flex",justifyContent:"center",alignItems:"center",sx:{flex:1},children:e.jsx(Ee,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(S,{sx:{position:"relative"},children:[e.jsx(W,{onClick:()=>t(-1),"aria-label":"regresar",sx:{padding:0},size:"large",children:e.jsx(k,{icon:"solar:round-arrow-left-line-duotone",sx:{width:24,height:24}})}),e.jsx(b,{variant:"h4",children:m||"Sin nombre asignado"}),e.jsxs(b,{variant:"body2",children:[a," - Actualizado"," ",ve(o==null?void 0:o.ultimaMedicion.timestamp)]}),e.jsx(W,{"aria-label":"actualizar",sx:{position:"absolute",top:0,right:0},onClick:()=>d(),children:e.jsx(k,{icon:"solar:restart-circle-line-duotone",width:35})})]}),e.jsx(S,{sx:{height:{xs:"auto",lg:"calc(100vh - 13rem)"}},children:e.jsx(ht,{})})]})})};function Ht(){return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsxs("title",{children:[" ",`IOT Details - ${fe.appName}`]})}),e.jsx(pt,{})]})}export{Ht as default};
