import{s as O,B as m,a0 as N,a1 as F,r as s,l as _,j as e,z as E,I as f,d as I,a2 as L,a3 as M,a4 as D,M as B,a5 as z,t as $,v as U,F as W,T as b,D as H,S as G,H as q}from"./index-DNJ-7_Rf.js";import{C as K}from"./config-global-CwnLHF89.js";import{a as Q,U as V,b as Z,_ as v,T as J,e as X,c as Y,d as ee,g as te}from"./user-table-toolbar-Dch0J8le.js";import{f as ae}from"./projects-BU-ZKPtw.js";import{c as se,d as C,T as oe,a as re,e as ne}from"./TableRow-DysWAKuU.js";import{C as le}from"./Checkbox-DQfe5e9M.js";import{u as ie}from"./index-CG6N1FjS.js";import{C as A}from"./Card-98N49c-B.js";import{T as ce}from"./TextField-DrqQKz-z.js";import{L as de}from"./LoadingButton-ibHk8LjJ.js";import"./KeyboardArrowRight-DgOaYwjI.js";import"./Select-C6NYPjTS.js";import"./useControlled-CYejl48w.js";import"./InputAdornment-CuTnuXim.js";import"./Tooltip-DbXBuVyG.js";import"./Popper-yRRR-Rwr.js";import"./SwitchBase-DJ_sWzg7.js";import"./index-BMHLmDq2.js";import"./CircularProgress-DypZclCl.js";const pe=O(m)(({theme:a,ownerState:{color:t,variant:o}})=>{const i={...t==="default"&&{...o==="filled"&&{color:a.vars.palette.common.white,backgroundColor:a.vars.palette.text.primary,[N.dark]:{color:a.vars.palette.grey[800]}},...o==="outlined"&&{backgroundColor:"transparent",color:a.vars.palette.text.primary,border:`2px solid ${a.vars.palette.text.primary}`},...o==="soft"&&{color:a.vars.palette.text.secondary,backgroundColor:F(a.vars.palette.grey["500Channel"],.16)},...o==="inverted"&&{color:a.vars.palette.grey[800],backgroundColor:a.vars.palette.grey[300]}}},n={...t!=="default"&&{...o==="filled"&&{color:a.vars.palette[t].contrastText,backgroundColor:a.vars.palette[t].main},...o==="outlined"&&{backgroundColor:"transparent",color:a.vars.palette[t].main,border:`2px solid ${a.vars.palette[t].main}`},...o==="soft"&&{color:a.vars.palette[t].dark,backgroundColor:F(a.vars.palette[t].mainChannel,.16),[N.dark]:{color:a.vars.palette[t].light}},...o==="inverted"&&{color:a.vars.palette[t].darker,backgroundColor:a.vars.palette[t].lighter}}};return{height:24,minWidth:24,lineHeight:0,cursor:"default",alignItems:"center",whiteSpace:"nowrap",display:"inline-flex",justifyContent:"center",padding:a.spacing(0,.75),fontSize:a.typography.pxToRem(12),fontWeight:a.typography.fontWeightBold,borderRadius:a.shape.borderRadius*.75,transition:a.transitions.create("all",{duration:a.transitions.duration.shorter}),...i,...n}}),R={root:"mnl__label__root",icon:"mnl__label__icon"},ue=s.forwardRef(({children:a,color:t="default",variant:o="soft",startIcon:i,endIcon:n,sx:u,className:r,...p},c)=>{const l=_(),g={width:16,height:16,"& svg, img":{width:1,height:1,objectFit:"cover"}};return e.jsxs(pe,{ref:c,component:"span",className:R.root.concat(r?` ${r}`:""),ownerState:{color:t,variant:o},sx:{...i&&{pl:.75},...n&&{pr:.75},...u},theme:l,...p,children:[i&&e.jsx(m,{component:"span",className:R.icon,sx:{mr:.75,...g},children:i}),typeof a=="string"?he(a):a,n&&e.jsx(m,{component:"span",className:R.icon,sx:{ml:.75,...g},children:n})]})});function he(a){return a.charAt(0).toUpperCase()+a.slice(1)}function ge({row:a,selected:t,onSelectRow:o}){const[i,n]=s.useState(null),u=s.useCallback(p=>{n(p.currentTarget)},[]),r=s.useCallback(()=>{n(null)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(se,{hover:!0,tabIndex:-1,role:"checkbox",selected:t,children:[e.jsx(C,{padding:"checkbox",children:e.jsx(le,{disableRipple:!0,checked:t,onChange:o})}),e.jsx(C,{component:"th",scope:"row",children:e.jsx(m,{gap:2,display:"flex",alignItems:"center",children:e.jsx(E,{to:`/analysis-result/${a.id}`,style:{textDecoration:"none",color:"inherit"},children:a.name})})}),e.jsx(C,{align:"center",children:a.status?e.jsx(f,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}}):"-"}),e.jsx(C,{children:e.jsx(ue,{color:a.status===!1&&"error"||"success",children:a.status===!1&&"Pendiente"||a.status===!0&&"Completado"})}),e.jsx(C,{align:"right",children:e.jsx(I,{onClick:u,children:e.jsx(f,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(L,{open:!!i,anchorEl:i,onClose:r,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(M,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${D.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${D.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(B,{onClick:r,children:[e.jsx(f,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(B,{onClick:r,sx:{color:"error.main"},children:[e.jsx(f,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}const xe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,boxShadow:24,pt:2,px:4,pb:3},me=({refetchData:a})=>{const{userData:t}=z(),[o,i]=s.useState(!1),n=()=>{i(!0)},u=()=>{i(!1)},[r,p]=s.useState(""),[c,l]=s.useState(null),[g,y]=s.useState(null),[P,j]=s.useState(!1),w=s.useCallback(async()=>{if(t&&r&&c)try{const h=new FormData;if(h.append("name",r),h.append("id",t==null?void 0:t.id.toString()),h.append("zipfile",c),j(!0),!(await fetch(`${$}/api/images/upload-zip`,{method:"POST",body:h})).ok){y("Error al subir el archivo");return}y(null),j(!1),p(""),l(null),u(),a()}catch(h){console.log(h)}},[t,r,c,a]),S=s.useCallback(h=>{h.length>0&&l(h[0])},[]),{getRootProps:d,getInputProps:x,isDragActive:k,acceptedFiles:T}=ie({onDrop:S,accept:{"application/zip":[".zip"]},maxFiles:1});return e.jsxs(e.Fragment,{children:[e.jsx(U,{variant:"contained",color:"inherit",startIcon:e.jsx(f,{icon:"mingcute:add-line"}),onClick:n,children:"Nuevo Proyecto"}),e.jsx(W,{open:o,onClose:u,"aria-labelledby":"child-modal-title","aria-describedby":"child-modal-description",children:e.jsxs(A,{sx:{...xe,width:{xs:"90%",sm:400,md:500,lg:600}},children:[e.jsxs(m,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(b,{variant:"h5",flexGrow:1,children:"Nuevo proyecto"}),e.jsx(I,{onClick:u,children:e.jsx(f,{icon:"eva:close-fill"})})]}),e.jsxs(m,{sx:{mt:3,mb:2},children:[e.jsx(ce,{fullWidth:!0,name:"name",label:"Nombre",InputLabelProps:{shrink:!0},placeholder:'rancho "El descanso"',value:r,onChange:h=>p(h.target.value)}),e.jsxs(m,{sx:{mt:3,height:120,border:1,borderColor:"primary.main",borderRadius:1,borderStyle:"dashed",padding:2},display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:1,...d(),children:[e.jsx("input",{...x()}),e.jsx(f,{icon:"bi:file-earmark-arrow-up",sx:{color:"primary.main"},width:36}),k?e.jsx(b,{variant:"body2",align:"center",children:"Suelta tus archivos aquí"}):e.jsx(b,{variant:"body2",align:"center",children:"Arrastra tu archivo aquí (.zip), o haz clic para seleccionarlos."}),T.length>0&&e.jsxs(b,{variant:"body2",children:["Archivo seleccionado: ",T[0].name]})]})]}),g&&e.jsx(b,{variant:"body2",color:"error",sx:{mb:1.5},children:g}),P&&e.jsx(b,{variant:"body2",color:"info",sx:{mb:1.5},children:"Subiendo archivo... (esto puede tardar unos minutos)"}),e.jsx(de,{variant:"contained",fullWidth:!0,onClick:w,loading:P,children:"Crear"})]})})]})};function be(){const{userData:a}=z(),t=fe(),[o,i]=s.useState([]),[n,u]=s.useState(""),r=Q({inputData:o,comparator:te(t.order,t.orderBy),filterName:n}),p=!r.length&&!!n,c=s.useCallback(async()=>{if(!a)return;const l=await ae(a.id);i(l)},[a]);return s.useEffect(()=>{c()},[c]),e.jsxs(H,{children:[e.jsxs(m,{display:"flex",alignItems:"center",mb:5,children:[e.jsx(b,{variant:"h4",flexGrow:1,children:"Proyectos"}),e.jsx(me,{refetchData:c})]}),e.jsxs(A,{children:[e.jsx(V,{numSelected:t.selected.length,filterName:n,onFilterName:l=>{u(l.target.value),t.onResetPage()}}),e.jsx(G,{children:e.jsx(oe,{sx:{overflow:"unset"},children:e.jsxs(re,{sx:{minWidth:800},children:[e.jsx(Z,{order:t.order,orderBy:t.orderBy,rowCount:v.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:l=>t.onSelectAllRows(l,v.map(g=>g.id)),headLabel:[{id:"name",label:"Name"},{id:"isVerified",label:"Verified",align:"center"},{id:"status",label:"Status"},{id:""}]}),e.jsxs(ne,{children:[r.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(l=>e.jsx(ge,{row:l,selected:t.selected.includes(String(l.id)),onSelectRow:()=>t.onSelectRow(String(l.id))},l.id)),e.jsx(J,{height:68,emptyRows:X(t.page,t.rowsPerPage,v.length)}),p&&e.jsx(Y,{searchQuery:n})]})]})})}),e.jsx(ee,{component:"div",page:t.page,count:v.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:t.onChangeRowsPerPage})]})]})}function fe(){const[a,t]=s.useState(0),[o,i]=s.useState("name"),[n,u]=s.useState(5),[r,p]=s.useState([]),[c,l]=s.useState("asc"),g=s.useCallback(d=>{l(o===d&&c==="asc"?"desc":"asc"),i(d)},[c,o]),y=s.useCallback((d,x)=>{if(d){p(x);return}p([])},[]),P=s.useCallback(d=>{const x=r.includes(d)?r.filter(k=>k!==d):[...r,d];p(x)},[r]),j=s.useCallback(()=>{t(0)},[]),w=s.useCallback((d,x)=>{t(x)},[]),S=s.useCallback(d=>{u(parseInt(d.target.value,10)),j()},[j]);return{page:a,order:c,onSort:g,orderBy:o,selected:r,rowsPerPage:n,onSelectRow:P,onResetPage:j,onChangePage:w,onSelectAllRows:y,onChangeRowsPerPage:S}}function Le(){return e.jsxs(e.Fragment,{children:[e.jsx(q,{children:e.jsxs("title",{children:[" ",`Proyectos - ${K.appName}`]})}),e.jsx(be,{})]})}export{Le as default};
