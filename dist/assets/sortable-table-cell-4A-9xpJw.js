import{z as e}from"./index-DnZn71We.js";import{r as m,j as d,I as y}from"./index-DNJ-7_Rf.js";import{u as M}from"./use-debounce-BKmKytjS.js";import{T as E}from"./TextField-DrqQKz-z.js";import{p as V}from"./Slider-CXET07Dr.js";import{d as W}from"./TableRow-DysWAKuU.js";const G=e.object({agua_suelo:e.string().transform(Number).pipe(e.number()).nullable(),aplicacion_id:e.string().nullable(),banda_id:e.string().nullable(),bateria:e.string().nullable(),conductividad_suelo:e.string().transform(Number).pipe(e.number()).nullable(),dispositivo_id:e.string(),id:e.number(),modelo_id:e.string().nullable(),nombre_dispositivo:e.string().nullable(),rssi:e.number().nullable(),snr:e.string().nullable().transform(Number).pipe(e.number()),temperatura_suelo:e.string().transform(Number).pipe(e.number()).nullable(),timestamp:e.string()}),R=e.object({soilWater:e.number().nullable(),applicationId:e.string().nullable(),bandId:e.string().nullable(),battery:e.string().nullable(),soilConductivity:e.number().nullable(),deviceId:e.string(),id:e.number(),modelId:e.string().nullable(),deviceName:e.string().nullable().nullable(),rssi:e.number().nullable(),snr:e.number().nullable(),soilTemperature:e.number().nullable(),timestamp:e.string()}),q=e.array(G.transform(r=>({soilWater:r.agua_suelo,applicationId:r.aplicacion_id,bandId:r.banda_id,battery:r.bateria,soilConductivity:r.conductividad_suelo,deviceId:r.dispositivo_id,id:r.id,modelId:r.modelo_id,deviceName:r.nombre_dispositivo,rssi:r.rssi,snr:r.snr,soilTemperature:r.temperatura_suelo,timestamp:r.timestamp}))),H=e.object({deviceId:e.string(),groupId:e.number().nullable(),groupName:e.string().nullable(),lat:e.number().nullable(),long:e.number().nullable(),deviceName:e.string().nullable(),lastMeasurement:e.object({soilWater:e.number().nullable(),applicationId:e.string().nullable(),bandId:e.string().nullable(),battery:e.number().nullable(),soilConductivity:e.number().nullable(),deviceId:e.string(),id:e.number(),modelId:e.string().nullable(),rssi:e.number().nullable(),snr:e.number().nullable(),soilTemperature:e.number().nullable(),timestamp:e.string()})}),O=e.array(e.object({dispositivo_id:e.string(),grupo_id:e.number().nullable(),grupo_name:e.string().nullable(),latitud:e.string().transform(Number).pipe(e.number()).nullable(),longitud:e.string().transform(Number).pipe(e.number()).nullable(),nombre_dispositivo:e.string().nullable(),primera_medicion:e.object({agua_suelo:e.string().transform(Number).pipe(e.number()).nullable(),aplicacion_id:e.string().nullable(),banda_id:e.string().nullable(),bateria:e.string().transform(Number).pipe(e.number()).nullable(),conductividad_suelo:e.string().transform(Number).pipe(e.number()).nullable(),dispositivo_id:e.string(),id:e.number(),modelo_id:e.string().nullable(),rssi:e.number().nullable(),snr:e.string().nullable().transform(Number).pipe(e.number()),temperatura_suelo:e.string().transform(Number).pipe(e.number()).nullable(),timestamp:e.string()})}).transform(r=>({deviceId:r.dispositivo_id,groupId:r.grupo_id,groupName:r.grupo_name,lat:r.latitud,long:r.longitud,deviceName:r.nombre_dispositivo,lastMeasurement:{soilWater:r.primera_medicion.agua_suelo,applicationId:r.primera_medicion.aplicacion_id,bandId:r.primera_medicion.banda_id,battery:r.primera_medicion.bateria,soilConductivity:r.primera_medicion.conductividad_suelo,deviceId:r.primera_medicion.dispositivo_id,id:r.primera_medicion.id,modelId:r.primera_medicion.modelo_id,rssi:r.primera_medicion.rssi,snr:r.primera_medicion.snr,soilTemperature:r.primera_medicion.temperatura_suelo,timestamp:r.primera_medicion.timestamp}}))),P=e.array(e.object({id:e.number(),device_id:e.string(),lat:e.string().transform(Number).pipe(e.number()).nullable(),long:e.string().transform(Number).pipe(e.number()).nullable(),nombre:e.string().nullable(),limite_superior:e.number().nullable(),limite_inferior:e.number().nullable(),coordenadas:e.string().nullable(),capacidadIdeal:e.string().transform(Number).pipe(e.number()).nullable(),rancho_id:e.number().nullable(),rancho:e.object({id:e.number(),nombre:e.string().nullable()}).nullable()}).transform(r=>{var t;return{id:r.id,deviceId:r.device_id,lat:r.lat,lng:r.long,name:r.nombre,topLimit:r.limite_superior,bottomLimit:r.limite_inferior,coordinates:r.coordenadas,idealCapacity:r.capacidadIdeal,ranchId:r.rancho_id,ranchName:((t=r==null?void 0:r.rancho)==null?void 0:t.nombre)||null}}));function U(r,t,l){const[a,s]=m.useState((l==null?void 0:l.defaultSort)??{key:"",direction:null}),[T,h]=m.useState(null),[c,C]=m.useState((l==null?void 0:l.defaultSearchQuery)??""),[b,w]=m.useState((l==null?void 0:l.defaultSearchKeys)??[]),f=(n,i)=>{if(i)return i.includes(".")?i.split(".").reduce((u,o)=>{if(u!=null)return u[o]},n):n[i]},x=(n,i,u)=>{if(n==null&&i==null)return 0;if(n==null)return 1;if(i==null)return-1;const o=Number(n),_=Number(i);if(!Number.isNaN(o)&&!Number.isNaN(_))return u==="asc"?o-_:_-o;const v=new Date(n),S=new Date(i);if(v.toString()!=="Invalid Date"&&S.toString()!=="Invalid Date")return u==="asc"?v.getTime()-S.getTime():S.getTime()-v.getTime();const I=String(n).toLowerCase(),N=String(i).toLowerCase();return u==="asc"?I.localeCompare(N):N.localeCompare(I)},p=m.useMemo(()=>{if(!r)return[];try{const i=e.array(t).parse(r);return h(null),i}catch(n){return n instanceof e.ZodError&&(h(n),console.error("Validation errors:",n.errors)),r}},[r,t]),D=n=>{s(i=>{if(i.key===n){const u=i.direction==="asc"?"desc":i.direction==="desc"?null:"asc";return{key:u===null?"":n,direction:u}}return{key:n,direction:"asc"}})},L=n=>a.key===n?a.direction:null,g=m.useMemo(()=>{if(!p||!c||b.length===0)return p;const n=c.toLowerCase();return p.filter(i=>b.some(u=>{const o=f(i,u);return o==null?!1:String(o).toLowerCase().includes(n)}))},[p,c,b]);return{sortedData:m.useMemo(()=>!g||!a.key||!a.direction?g:[...g].sort((n,i)=>{const u=f(n,a.key),o=f(i,a.key);return x(u,o,a.direction)}),[g,a]),sortConfig:a,requestSort:D,getSortDirection:L,validationErrors:T,setSearchQuery:C,setSearchKeys:w,searchQuery:c,searchKeys:b}}const Z=({onSearch:r})=>{const[t,l]=m.useState(""),a=M(t,500);return m.useEffect(()=>{r(a)},[a,r]),d.jsx(E,{fullWidth:!0,placeholder:"Buscar sensor",value:t,onChange:s=>l(s.target.value)})};function J(r){const t=V(r),a=(new Date().getTime()-t.getTime())/(1e3*60*60);let s="";return a<1?s="#28a745":a<10?s="#fd7e14":a<24?s="#dc3545":s="#6c757d",s}const X=(r,t)=>{r.stopPropagation(),navigator.clipboard.writeText(t)},Y=({children:r,sortKey:t,requestSort:l,getSortDirection:a})=>{const s=a(t);return d.jsx(W,{onClick:()=>l(t),sx:{cursor:"pointer",userSelect:"none",whiteSpace:"nowrap"},"aria-sort":s==="asc"?"ascending":s==="desc"?"descending":"none",children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r,s==="asc"&&d.jsx(y,{icon:"solar:alt-arrow-up-line-duotone",width:"16"}),s==="desc"&&d.jsx(y,{icon:"solar:alt-arrow-down-line-duotone",width:"16"})]})})};export{q as G,Z as S,P as a,Y as b,X as c,O as d,H as e,J as g,R as t,U as u};
