import{j as o,t as a}from"./index-DNJ-7_Rf.js";import{A as t}from"./index.modern-BSJ2A2Eu.js";import{z as r}from"./index-DnZn71We.js";const f=({children:e})=>o.jsx(t,{apiKey:"AIzaSyB_LTdB65XirnWx_f6IrloEw0_Gc70L0ps",children:e}),s=r.object({lat:r.number(),lng:r.number()}),u=r.object({tipo:r.literal("poligono"),coords:r.array(s)}),m=r.string().transform((e,n)=>{try{const i=JSON.parse(e),l=u.safeParse(i);return l.success?l.data:null}catch{return null}}).nullable(),b=r.object({device_id:r.string(),grupo_id:r.number().nullable(),grupo_name:r.string(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable(),nombre:r.string().nullable(),capacidadIdeal:r.string().transform(Number).pipe(r.number()).nullable(),limite_inferior:r.number().nullable(),limite_superior:r.number().nullable(),coordenadas:r.string().nullable(),ultimaMedicion:r.object({id:r.number(),dispositivo_id:r.string(),aplicacion_id:r.string(),bateria:r.string().transform(Number).pipe(r.number()).nullable(),temperatura_suelo:r.string().transform(Number).pipe(r.number()).nullable(),conductividad_suelo:r.string().transform(Number).pipe(r.number()).nullable(),agua_suelo:r.string().transform(Number).pipe(r.number()).nullable(),banda_id:r.string().nullable(),modelo_id:r.string().nullable(),timestamp:r.string().nullable(),rssi:r.number().nullable(),snr:r.string().transform(Number).pipe(r.number()).nullable()})}).transform(e=>({deviceId:e.device_id,groupId:e.grupo_id,groupName:e.grupo_name,lat:e.lat,long:e.long,name:e.nombre,idealCapacity:e.capacidadIdeal,bottomLimit:e.limite_inferior,topLimit:e.limite_superior,areaCoordinates:e.coordenadas,lastMeasurement:{id:e.ultimaMedicion.id,deviceId:e.ultimaMedicion.dispositivo_id,applicationId:e.ultimaMedicion.aplicacion_id,battery:e.ultimaMedicion.bateria,soilTemperature:e.ultimaMedicion.temperatura_suelo,soilConductivity:e.ultimaMedicion.conductividad_suelo,soilMoisture:e.ultimaMedicion.agua_suelo,bandId:e.ultimaMedicion.banda_id,modelId:e.ultimaMedicion.modelo_id,timestamp:e.ultimaMedicion.timestamp,rssi:e.ultimaMedicion.rssi,snr:e.ultimaMedicion.snr}}));r.record(r.string(),r.array(b));r.object({id:r.number(),device_id:r.string(),nombre:r.string().nullable(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable()});const _=r.array(r.object({id:r.number(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable(),nombre:r.string().nullable(),area:r.union([r.string().transform(e=>{try{return JSON.parse(e)}catch{return null}}),r.object({coordenadas:r.unknown()}).nullable()]).pipe(r.object({coordenadas:r.union([r.array(r.array(r.number())),r.array(r.object({lat:r.number(),lng:r.number()})),r.array(r.array(r.object({lat:r.number(),lng:r.number()})))])}).nullable()),sensores:r.array(r.object({id:r.number(),device_id:r.string(),nombre:r.string().nullable(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable()}))})).transform(e=>e.map(n=>({id:n.id,lat:n.lat,long:n.long,name:n.nombre,area:n.area?{coordinates:Array.isArray(n.area.coordenadas)?n.area.coordenadas.map(i=>Array.isArray(i)?i.map(l=>typeof l=="number"?{lat:l[0],lng:l[1]}:l):i):[]}:null,sensors:n.sensores.map(i=>({id:i.id,deviceId:i.device_id,name:i.nombre,lat:i.lat,long:i.long}))}))),y=r.array(r.object({device_id:r.string(),id:r.number(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable(),nombre:r.string().nullable()})).transform(e=>e.map(n=>({deviceId:n.device_id,id:n.id,lat:n.lat,long:n.long,name:n.nombre}))),N=r.array(r.object({area:r.string().nullable(),id:r.number(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable(),nombre:r.string().nullable()}).nullable()).transform(e=>e.filter(n=>n!==null).map(n=>({id:n.id,lat:n.lat,long:n.long,name:n.nombre,area:n.area})));r.object({success:r.boolean(),data:r.array(r.object({sensor_id:r.number(),tipo:r.string().nullable(),dispositivo_id:r.string(),nombre:r.string().nullable(),ubicacion:r.object({lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable()}),limites:r.object({superior:r.number().nullable(),inferior:r.number().nullable()}),capacidadIdeal:r.string().transform(Number).pipe(r.number()).nullable(),ultima_medicion:r.object({timestamp:r.string(),bateria:r.string().transform(Number).pipe(r.number()).nullable(),temperatura:r.string().transform(Number).pipe(r.number()).nullable(),conductividad:r.string().transform(Number).pipe(r.number()).nullable(),humedad:r.string().transform(Number).pipe(r.number()).nullable(),señal:r.object({rssi:r.number().nullable(),snr:r.string().transform(Number).pipe(r.number()).nullable()})})})),message:r.string()}).transform(e=>({success:e.success,message:e.message,data:e.data.map(n=>({id:n.sensor_id,type:n.tipo,deviceId:n.dispositivo_id,name:n.nombre,lat:n.ubicacion.lat,long:n.ubicacion.long,topLimit:n.limites.superior,bottomLimit:n.limites.inferior,idealCapacity:n.capacidadIdeal,lastMeasurement:{timestamp:n.ultima_medicion.timestamp,battery:n.ultima_medicion.bateria,temperature:n.ultima_medicion.temperatura,conductivity:n.ultima_medicion.conductividad,soilMoisture:n.ultima_medicion.humedad,rssi:n.ultima_medicion.señal.rssi,snr:n.ultima_medicion.señal.snr}}))}));const M=r.object({success:r.boolean(),message:r.string(),data:r.object({asignados:r.array(r.object({correo:r.string(),id:r.number(),nombre:r.string().nullable(),region:r.string().nullable(),telefono:r.string().nullable()})),no_asignados:r.array(r.object({correo:r.string(),id:r.number(),nombre:r.string().nullable(),region:r.string().nullable(),telefono:r.string().nullable()}))})}).transform(e=>({success:e.success,message:e.message,data:{assigned:e.data.asignados.map(n=>({id:n.id,email:n.correo,name:n.nombre,region:n.region,phone:n.telefono})),notAssigned:e.data.no_asignados.map(n=>({id:n.id,email:n.correo,name:n.nombre,region:n.region,phone:n.telefono}))}})),d=r.array(r.object({cluster:r.object({id:r.number(),rancho_id:r.number(),sensor_15_id:r.number().nullable(),sensor_30_id:r.number().nullable(),nombre:r.string().nullable(),color:r.string().nullable(),tipo:r.string().nullable(),lat:r.string().transform(Number).pipe(r.number()).nullable(),lng:r.string().transform(Number).pipe(r.number()).nullable(),area:m}).transform(e=>({id:e.id,ranchId:e.rancho_id,sensor15Id:e.sensor_15_id,sensor30Id:e.sensor_30_id,name:e.nombre,color:e.color,type:e.tipo,lat:e.lat,lng:e.lng,area:e.area?{coordinates:e.area.coords}:null})),sensor15:r.object({info:r.object({id:r.number(),device_id:r.string(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable(),nombre:r.string().nullable(),limite_superior:r.number().nullable(),limite_inferior:r.number().nullable(),coordenadas:r.string().nullable(),capacidadIdeal:r.string().transform(Number).pipe(r.number()).nullable(),rancho_id:r.number().nullable()}).nullable(),ultimaMedicion:r.object({id:r.number(),dispositivo_id:r.string(),aplicacion_id:r.string().nullable(),bateria:r.string().transform(Number).pipe(r.number()).nullable(),temperatura_suelo:r.string().transform(Number).pipe(r.number()).nullable(),conductividad_suelo:r.string().transform(Number).pipe(r.number()).nullable(),agua_suelo:r.string().transform(Number).pipe(r.number()).nullable(),banda_id:r.string().nullable(),modelo_id:r.string().nullable(),timestamp:r.string().nullable(),rssi:r.number().nullable(),snr:r.string().transform(Number).pipe(r.number()).nullable()}).nullable()}).nullable().transform(e=>e?{info:e.info?{id:e.info.id,deviceId:e.info.device_id,name:e.info.nombre,lat:e.info.lat,lng:e.info.long,topLimit:e.info.limite_superior,bottomLimit:e.info.limite_inferior,coordinates:e.info.coordenadas,idalCapacity:e.info.capacidadIdeal,ranchoId:e.info.rancho_id}:null,lastMeasurement:e.ultimaMedicion?{id:e.ultimaMedicion.id,deviceId:e.ultimaMedicion.dispositivo_id,applicationId:e.ultimaMedicion.aplicacion_id,battery:e.ultimaMedicion.bateria,soilTemperature:e.ultimaMedicion.temperatura_suelo,soilConductivity:e.ultimaMedicion.conductividad_suelo,soilMoisture:e.ultimaMedicion.agua_suelo,bandId:e.ultimaMedicion.banda_id,modelId:e.ultimaMedicion.modelo_id,timestamp:e.ultimaMedicion.timestamp,rssi:e.ultimaMedicion.rssi,snr:e.ultimaMedicion.snr}:null}:null),sensor30:r.object({info:r.object({id:r.number(),device_id:r.string(),lat:r.string().transform(Number).pipe(r.number()).nullable(),long:r.string().transform(Number).pipe(r.number()).nullable(),nombre:r.string().nullable(),limite_superior:r.number().nullable(),limite_inferior:r.number().nullable(),coordenadas:r.string().nullable(),capacidadIdeal:r.string().transform(Number).pipe(r.number()).nullable(),rancho_id:r.number().nullable()}).nullable(),ultimaMedicion:r.object({id:r.number(),dispositivo_id:r.string(),aplicacion_id:r.string().nullable(),bateria:r.string().transform(Number).pipe(r.number()).nullable(),temperatura_suelo:r.string().transform(Number).pipe(r.number()).nullable(),conductividad_suelo:r.string().transform(Number).pipe(r.number()).nullable(),agua_suelo:r.string().transform(Number).pipe(r.number()).nullable(),banda_id:r.string().nullable(),modelo_id:r.string().nullable(),timestamp:r.string().nullable(),rssi:r.number().nullable(),snr:r.string().transform(Number).pipe(r.number()).nullable()}).nullable()}).nullable().transform(e=>e?{info:e.info?{id:e.info.id,deviceId:e.info.device_id,name:e.info.nombre,lat:e.info.lat,lng:e.info.long,topLimit:e.info.limite_superior,bottomLimit:e.info.limite_inferior,coordinates:e.info.coordenadas,idalCapacity:e.info.capacidadIdeal,ranchoId:e.info.rancho_id}:null,lastMeasurement:e.ultimaMedicion?{id:e.ultimaMedicion.id,deviceId:e.ultimaMedicion.dispositivo_id,applicationId:e.ultimaMedicion.aplicacion_id,battery:e.ultimaMedicion.bateria,soilTemperature:e.ultimaMedicion.temperatura_suelo,soilConductivity:e.ultimaMedicion.conductividad_suelo,soilMoisture:e.ultimaMedicion.agua_suelo,bandId:e.ultimaMedicion.banda_id,modelId:e.ultimaMedicion.modelo_id,timestamp:e.ultimaMedicion.timestamp,rssi:e.ultimaMedicion.rssi,snr:e.ultimaMedicion.snr}:null}:null)})),I=async e=>{try{const n={rancho_id:e.ranchoId,nombre:e.name,lat:e.lat,lng:e.long,area:{tipo:"poligono",coords:e.coordinatesArea},tipo:e.type,color:e.color};e.sensor15ID&&(n.sensor_15_id=e.sensor15ID),e.sensor30ID&&(n.sensor_30_id=e.sensor30ID);const i=await fetch(`${a}/api/clusters`,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Network response was not ok");if(i.status!==201)throw new Error("Your cluster could not be created.")}catch(n){throw new Error(`Failed to create sensor: ${n}`)}},h=async e=>{try{const n=await fetch(`${a}/api/clusters/por-rancho/${e}`),i=await n.json();if(n.status===404&&(i==null?void 0:i.message)==="No se encontraron clusters para este rancho")return[];if(!n.ok)throw Error("Network response was not ok");return d.parse(i)}catch(n){throw n instanceof r.ZodError?(console.error("Validation error:",n.errors),Error(n.message)):Error(n)}},j=async e=>{try{const n={rancho_id:e.ranchoId,nombre:e.name,lat:e.lat,lng:e.long,area:{tipo:"poligono",coords:e.coordinatesArea},tipo:e.type,color:e.color,sensor_15_id:e.sensor15ID,sensor_30_id:e.sensor30ID},i=await fetch(`${a}/api/clusters/${e.clusterId}`,{method:"PUT",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Network response was not ok");if(i.status!==200)throw new Error("Your cluster could not be edited.")}catch(n){throw new Error(`Failed to create sensor: ${n}`)}},w=async e=>{try{if((await fetch(`${a}/api/clusters/${e}`,{method:"DELETE"})).status!==200)throw new Error("Network response was not ok")}catch(n){throw new Error(`Failed to delete cluster: ${n}`)}};export{_ as G,f as R,y as a,M as b,I as c,w as d,j as e,N as f,h as g};
